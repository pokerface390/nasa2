{
  "version": 3,
  "sources": ["../../three/examples/jsm/controls/FirstPersonControls.js"],
  "sourcesContent": ["import {\n\tControls,\n\tMathUtils,\n\tSpherical,\n\tVector3\n} from 'three';\n\nconst _lookDirection = new Vector3();\nconst _spherical = new Spherical();\nconst _target = new Vector3();\nconst _targetPosition = new Vector3();\n\nclass FirstPersonControls extends Controls {\n\n\tconstructor( object, domElement = null ) {\n\n\t\tsuper( object, domElement );\n\n\t\t// API\n\n\t\tthis.movementSpeed = 1.0;\n\t\tthis.lookSpeed = 0.005;\n\n\t\tthis.lookVertical = true;\n\t\tthis.autoForward = false;\n\n\t\tthis.activeLook = true;\n\n\t\tthis.heightSpeed = false;\n\t\tthis.heightCoef = 1.0;\n\t\tthis.heightMin = 0.0;\n\t\tthis.heightMax = 1.0;\n\n\t\tthis.constrainVertical = false;\n\t\tthis.verticalMin = 0;\n\t\tthis.verticalMax = Math.PI;\n\n\t\tthis.mouseDragOn = false;\n\n\t\t// internals\n\n\t\tthis._autoSpeedFactor = 0.0;\n\n\t\tthis._pointerX = 0;\n\t\tthis._pointerY = 0;\n\n\t\tthis._moveForward = false;\n\t\tthis._moveBackward = false;\n\t\tthis._moveLeft = false;\n\t\tthis._moveRight = false;\n\n\t\tthis._viewHalfX = 0;\n\t\tthis._viewHalfY = 0;\n\n\t\tthis._lat = 0;\n\t\tthis._lon = 0;\n\n\t\t// event listeners\n\n\t\tthis._onPointerMove = onPointerMove.bind( this );\n\t\tthis._onPointerDown = onPointerDown.bind( this );\n\t\tthis._onPointerUp = onPointerUp.bind( this );\n\t\tthis._onContextMenu = onContextMenu.bind( this );\n\t\tthis._onKeyDown = onKeyDown.bind( this );\n\t\tthis._onKeyUp = onKeyUp.bind( this );\n\n\t\t//\n\n\t\tif ( domElement !== null ) {\n\n\t\t\tthis.connect();\n\n\t\t\tthis.handleResize();\n\n\t\t}\n\n\t\tthis._setOrientation();\n\n\t}\n\n\tconnect() {\n\n\t\twindow.addEventListener( 'keydown', this._onKeyDown );\n\t\twindow.addEventListener( 'keyup', this._onKeyUp );\n\n\t\tthis.domElement.addEventListener( 'pointermove', this._onPointerMove );\n\t\tthis.domElement.addEventListener( 'pointerdown', this._onPointerDown );\n\t\tthis.domElement.addEventListener( 'pointerup', this._onPointerUp );\n\t\tthis.domElement.addEventListener( 'contextmenu', this._onContextMenu );\n\n\t}\n\n\tdisconnect() {\n\n\t\twindow.removeEventListener( 'keydown', this._onKeyDown );\n\t\twindow.removeEventListener( 'keyup', this._onKeyUp );\n\n\t\tthis.domElement.removeEventListener( 'pointerdown', this._onPointerMove );\n\t\tthis.domElement.removeEventListener( 'pointermove', this._onPointerDown );\n\t\tthis.domElement.removeEventListener( 'pointerup', this._onPointerUp );\n\t\tthis.domElement.removeEventListener( 'contextmenu', this._onContextMenu );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.disconnect();\n\n\t}\n\n\thandleResize() {\n\n\t\tif ( this.domElement === document ) {\n\n\t\t\tthis._viewHalfX = window.innerWidth / 2;\n\t\t\tthis._viewHalfY = window.innerHeight / 2;\n\n\t\t} else {\n\n\t\t\tthis._viewHalfX = this.domElement.offsetWidth / 2;\n\t\t\tthis._viewHalfY = this.domElement.offsetHeight / 2;\n\n\t\t}\n\n\t}\n\n\tlookAt( x, y, z ) {\n\n\t\tif ( x.isVector3 ) {\n\n\t\t\t_target.copy( x );\n\n\t\t} else {\n\n\t\t\t_target.set( x, y, z );\n\n\t\t}\n\n\t\tthis.object.lookAt( _target );\n\n\t\tthis._setOrientation();\n\n\t\treturn this;\n\n\t}\n\n\tupdate( delta ) {\n\n\t\tif ( this.enabled === false ) return;\n\n\t\tif ( this.heightSpeed ) {\n\n\t\t\tconst y = MathUtils.clamp( this.object.position.y, this.heightMin, this.heightMax );\n\t\t\tconst heightDelta = y - this.heightMin;\n\n\t\t\tthis._autoSpeedFactor = delta * ( heightDelta * this.heightCoef );\n\n\t\t} else {\n\n\t\t\tthis._autoSpeedFactor = 0.0;\n\n\t\t}\n\n\t\tconst actualMoveSpeed = delta * this.movementSpeed;\n\n\t\tif ( this._moveForward || ( this.autoForward && ! this._moveBackward ) ) this.object.translateZ( - ( actualMoveSpeed + this._autoSpeedFactor ) );\n\t\tif ( this._moveBackward ) this.object.translateZ( actualMoveSpeed );\n\n\t\tif ( this._moveLeft ) this.object.translateX( - actualMoveSpeed );\n\t\tif ( this._moveRight ) this.object.translateX( actualMoveSpeed );\n\n\t\tif ( this._moveUp ) this.object.translateY( actualMoveSpeed );\n\t\tif ( this._moveDown ) this.object.translateY( - actualMoveSpeed );\n\n\t\tlet actualLookSpeed = delta * this.lookSpeed;\n\n\t\tif ( ! this.activeLook ) {\n\n\t\t\tactualLookSpeed = 0;\n\n\t\t}\n\n\t\tlet verticalLookRatio = 1;\n\n\t\tif ( this.constrainVertical ) {\n\n\t\t\tverticalLookRatio = Math.PI / ( this.verticalMax - this.verticalMin );\n\n\t\t}\n\n\t\tthis._lon -= this._pointerX * actualLookSpeed;\n\t\tif ( this.lookVertical ) this._lat -= this._pointerY * actualLookSpeed * verticalLookRatio;\n\n\t\tthis._lat = Math.max( - 85, Math.min( 85, this._lat ) );\n\n\t\tlet phi = MathUtils.degToRad( 90 - this._lat );\n\t\tconst theta = MathUtils.degToRad( this._lon );\n\n\t\tif ( this.constrainVertical ) {\n\n\t\t\tphi = MathUtils.mapLinear( phi, 0, Math.PI, this.verticalMin, this.verticalMax );\n\n\t\t}\n\n\t\tconst position = this.object.position;\n\n\t\t_targetPosition.setFromSphericalCoords( 1, phi, theta ).add( position );\n\n\t\tthis.object.lookAt( _targetPosition );\n\n\t}\n\n\t_setOrientation() {\n\n\t\tconst quaternion = this.object.quaternion;\n\n\t\t_lookDirection.set( 0, 0, - 1 ).applyQuaternion( quaternion );\n\t\t_spherical.setFromVector3( _lookDirection );\n\n\t\tthis._lat = 90 - MathUtils.radToDeg( _spherical.phi );\n\t\tthis._lon = MathUtils.radToDeg( _spherical.theta );\n\n\t}\n\n}\n\nfunction onPointerDown( event ) {\n\n\tif ( this.domElement !== document ) {\n\n\t\tthis.domElement.focus();\n\n\t}\n\n\tif ( this.activeLook ) {\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0: this._moveForward = true; break;\n\t\t\tcase 2: this._moveBackward = true; break;\n\n\t\t}\n\n\t}\n\n\tthis.mouseDragOn = true;\n\n}\n\nfunction onPointerUp( event ) {\n\n\tif ( this.activeLook ) {\n\n\t\tswitch ( event.button ) {\n\n\t\t\tcase 0: this._moveForward = false; break;\n\t\t\tcase 2: this._moveBackward = false; break;\n\n\t\t}\n\n\t}\n\n\tthis.mouseDragOn = false;\n\n}\n\nfunction onPointerMove( event ) {\n\n\tif ( this.domElement === document ) {\n\n\t\tthis._pointerX = event.pageX - this._viewHalfX;\n\t\tthis._pointerY = event.pageY - this._viewHalfY;\n\n\t} else {\n\n\t\tthis._pointerX = event.pageX - this.domElement.offsetLeft - this._viewHalfX;\n\t\tthis._pointerY = event.pageY - this.domElement.offsetTop - this._viewHalfY;\n\n\t}\n\n}\n\nfunction onKeyDown( event ) {\n\n\tswitch ( event.code ) {\n\n\t\tcase 'ArrowUp':\n\t\tcase 'KeyW': this._moveForward = true; break;\n\n\t\tcase 'ArrowLeft':\n\t\tcase 'KeyA': this._moveLeft = true; break;\n\n\t\tcase 'ArrowDown':\n\t\tcase 'KeyS': this._moveBackward = true; break;\n\n\t\tcase 'ArrowRight':\n\t\tcase 'KeyD': this._moveRight = true; break;\n\n\t\tcase 'KeyR': this._moveUp = true; break;\n\t\tcase 'KeyF': this._moveDown = true; break;\n\n\t}\n\n}\n\nfunction onKeyUp( event ) {\n\n\tswitch ( event.code ) {\n\n\t\tcase 'ArrowUp':\n\t\tcase 'KeyW': this._moveForward = false; break;\n\n\t\tcase 'ArrowLeft':\n\t\tcase 'KeyA': this._moveLeft = false; break;\n\n\t\tcase 'ArrowDown':\n\t\tcase 'KeyS': this._moveBackward = false; break;\n\n\t\tcase 'ArrowRight':\n\t\tcase 'KeyD': this._moveRight = false; break;\n\n\t\tcase 'KeyR': this._moveUp = false; break;\n\t\tcase 'KeyF': this._moveDown = false; break;\n\n\t}\n\n}\n\nfunction onContextMenu( event ) {\n\n\tif ( this.enabled === false ) return;\n\n\tevent.preventDefault();\n\n}\n\nexport { FirstPersonControls };\n"],
  "mappings": ";;;;;;;;AAOA,IAAM,iBAAiB,IAAI,QAAQ;AACnC,IAAM,aAAa,IAAI,UAAU;AACjC,IAAM,UAAU,IAAI,QAAQ;AAC5B,IAAM,kBAAkB,IAAI,QAAQ;AAEpC,IAAM,sBAAN,cAAkC,SAAS;AAAA,EAE1C,YAAa,QAAQ,aAAa,MAAO;AAExC,UAAO,QAAQ,UAAW;AAI1B,SAAK,gBAAgB;AACrB,SAAK,YAAY;AAEjB,SAAK,eAAe;AACpB,SAAK,cAAc;AAEnB,SAAK,aAAa;AAElB,SAAK,cAAc;AACnB,SAAK,aAAa;AAClB,SAAK,YAAY;AACjB,SAAK,YAAY;AAEjB,SAAK,oBAAoB;AACzB,SAAK,cAAc;AACnB,SAAK,cAAc,KAAK;AAExB,SAAK,cAAc;AAInB,SAAK,mBAAmB;AAExB,SAAK,YAAY;AACjB,SAAK,YAAY;AAEjB,SAAK,eAAe;AACpB,SAAK,gBAAgB;AACrB,SAAK,YAAY;AACjB,SAAK,aAAa;AAElB,SAAK,aAAa;AAClB,SAAK,aAAa;AAElB,SAAK,OAAO;AACZ,SAAK,OAAO;AAIZ,SAAK,iBAAiB,cAAc,KAAM,IAAK;AAC/C,SAAK,iBAAiB,cAAc,KAAM,IAAK;AAC/C,SAAK,eAAe,YAAY,KAAM,IAAK;AAC3C,SAAK,iBAAiB,cAAc,KAAM,IAAK;AAC/C,SAAK,aAAa,UAAU,KAAM,IAAK;AACvC,SAAK,WAAW,QAAQ,KAAM,IAAK;AAInC,QAAK,eAAe,MAAO;AAE1B,WAAK,QAAQ;AAEb,WAAK,aAAa;AAAA,IAEnB;AAEA,SAAK,gBAAgB;AAAA,EAEtB;AAAA,EAEA,UAAU;AAET,WAAO,iBAAkB,WAAW,KAAK,UAAW;AACpD,WAAO,iBAAkB,SAAS,KAAK,QAAS;AAEhD,SAAK,WAAW,iBAAkB,eAAe,KAAK,cAAe;AACrE,SAAK,WAAW,iBAAkB,eAAe,KAAK,cAAe;AACrE,SAAK,WAAW,iBAAkB,aAAa,KAAK,YAAa;AACjE,SAAK,WAAW,iBAAkB,eAAe,KAAK,cAAe;AAAA,EAEtE;AAAA,EAEA,aAAa;AAEZ,WAAO,oBAAqB,WAAW,KAAK,UAAW;AACvD,WAAO,oBAAqB,SAAS,KAAK,QAAS;AAEnD,SAAK,WAAW,oBAAqB,eAAe,KAAK,cAAe;AACxE,SAAK,WAAW,oBAAqB,eAAe,KAAK,cAAe;AACxE,SAAK,WAAW,oBAAqB,aAAa,KAAK,YAAa;AACpE,SAAK,WAAW,oBAAqB,eAAe,KAAK,cAAe;AAAA,EAEzE;AAAA,EAEA,UAAU;AAET,SAAK,WAAW;AAAA,EAEjB;AAAA,EAEA,eAAe;AAEd,QAAK,KAAK,eAAe,UAAW;AAEnC,WAAK,aAAa,OAAO,aAAa;AACtC,WAAK,aAAa,OAAO,cAAc;AAAA,IAExC,OAAO;AAEN,WAAK,aAAa,KAAK,WAAW,cAAc;AAChD,WAAK,aAAa,KAAK,WAAW,eAAe;AAAA,IAElD;AAAA,EAED;AAAA,EAEA,OAAQ,GAAG,GAAG,GAAI;AAEjB,QAAK,EAAE,WAAY;AAElB,cAAQ,KAAM,CAAE;AAAA,IAEjB,OAAO;AAEN,cAAQ,IAAK,GAAG,GAAG,CAAE;AAAA,IAEtB;AAEA,SAAK,OAAO,OAAQ,OAAQ;AAE5B,SAAK,gBAAgB;AAErB,WAAO;AAAA,EAER;AAAA,EAEA,OAAQ,OAAQ;AAEf,QAAK,KAAK,YAAY,MAAQ;AAE9B,QAAK,KAAK,aAAc;AAEvB,YAAM,IAAI,UAAU,MAAO,KAAK,OAAO,SAAS,GAAG,KAAK,WAAW,KAAK,SAAU;AAClF,YAAM,cAAc,IAAI,KAAK;AAE7B,WAAK,mBAAmB,SAAU,cAAc,KAAK;AAAA,IAEtD,OAAO;AAEN,WAAK,mBAAmB;AAAA,IAEzB;AAEA,UAAM,kBAAkB,QAAQ,KAAK;AAErC,QAAK,KAAK,gBAAkB,KAAK,eAAe,CAAE,KAAK,cAAkB,MAAK,OAAO,WAAY,EAAI,kBAAkB,KAAK,iBAAmB;AAC/I,QAAK,KAAK,cAAgB,MAAK,OAAO,WAAY,eAAgB;AAElE,QAAK,KAAK,UAAY,MAAK,OAAO,WAAY,CAAE,eAAgB;AAChE,QAAK,KAAK,WAAa,MAAK,OAAO,WAAY,eAAgB;AAE/D,QAAK,KAAK,QAAU,MAAK,OAAO,WAAY,eAAgB;AAC5D,QAAK,KAAK,UAAY,MAAK,OAAO,WAAY,CAAE,eAAgB;AAEhE,QAAI,kBAAkB,QAAQ,KAAK;AAEnC,QAAK,CAAE,KAAK,YAAa;AAExB,wBAAkB;AAAA,IAEnB;AAEA,QAAI,oBAAoB;AAExB,QAAK,KAAK,mBAAoB;AAE7B,0BAAoB,KAAK,MAAO,KAAK,cAAc,KAAK;AAAA,IAEzD;AAEA,SAAK,QAAQ,KAAK,YAAY;AAC9B,QAAK,KAAK,aAAe,MAAK,QAAQ,KAAK,YAAY,kBAAkB;AAEzE,SAAK,OAAO,KAAK,IAAK,KAAM,KAAK,IAAK,IAAI,KAAK,IAAK,CAAE;AAEtD,QAAI,MAAM,UAAU,SAAU,KAAK,KAAK,IAAK;AAC7C,UAAM,QAAQ,UAAU,SAAU,KAAK,IAAK;AAE5C,QAAK,KAAK,mBAAoB;AAE7B,YAAM,UAAU,UAAW,KAAK,GAAG,KAAK,IAAI,KAAK,aAAa,KAAK,WAAY;AAAA,IAEhF;AAEA,UAAM,WAAW,KAAK,OAAO;AAE7B,oBAAgB,uBAAwB,GAAG,KAAK,KAAM,EAAE,IAAK,QAAS;AAEtE,SAAK,OAAO,OAAQ,eAAgB;AAAA,EAErC;AAAA,EAEA,kBAAkB;AAEjB,UAAM,aAAa,KAAK,OAAO;AAE/B,mBAAe,IAAK,GAAG,GAAG,EAAI,EAAE,gBAAiB,UAAW;AAC5D,eAAW,eAAgB,cAAe;AAE1C,SAAK,OAAO,KAAK,UAAU,SAAU,WAAW,GAAI;AACpD,SAAK,OAAO,UAAU,SAAU,WAAW,KAAM;AAAA,EAElD;AAED;AAEA,SAAS,cAAe,OAAQ;AAE/B,MAAK,KAAK,eAAe,UAAW;AAEnC,SAAK,WAAW,MAAM;AAAA,EAEvB;AAEA,MAAK,KAAK,YAAa;AAEtB,YAAS,MAAM,QAAS;AAAA,MAEvB,KAAK;AAAG,aAAK,eAAe;AAAM;AAAA,MAClC,KAAK;AAAG,aAAK,gBAAgB;AAAM;AAAA,IAEpC;AAAA,EAED;AAEA,OAAK,cAAc;AAEpB;AAEA,SAAS,YAAa,OAAQ;AAE7B,MAAK,KAAK,YAAa;AAEtB,YAAS,MAAM,QAAS;AAAA,MAEvB,KAAK;AAAG,aAAK,eAAe;AAAO;AAAA,MACnC,KAAK;AAAG,aAAK,gBAAgB;AAAO;AAAA,IAErC;AAAA,EAED;AAEA,OAAK,cAAc;AAEpB;AAEA,SAAS,cAAe,OAAQ;AAE/B,MAAK,KAAK,eAAe,UAAW;AAEnC,SAAK,YAAY,MAAM,QAAQ,KAAK;AACpC,SAAK,YAAY,MAAM,QAAQ,KAAK;AAAA,EAErC,OAAO;AAEN,SAAK,YAAY,MAAM,QAAQ,KAAK,WAAW,aAAa,KAAK;AACjE,SAAK,YAAY,MAAM,QAAQ,KAAK,WAAW,YAAY,KAAK;AAAA,EAEjE;AAED;AAEA,SAAS,UAAW,OAAQ;AAE3B,UAAS,MAAM,MAAO;AAAA,IAErB,KAAK;AAAA,IACL,KAAK;AAAQ,WAAK,eAAe;AAAM;AAAA,IAEvC,KAAK;AAAA,IACL,KAAK;AAAQ,WAAK,YAAY;AAAM;AAAA,IAEpC,KAAK;AAAA,IACL,KAAK;AAAQ,WAAK,gBAAgB;AAAM;AAAA,IAExC,KAAK;AAAA,IACL,KAAK;AAAQ,WAAK,aAAa;AAAM;AAAA,IAErC,KAAK;AAAQ,WAAK,UAAU;AAAM;AAAA,IAClC,KAAK;AAAQ,WAAK,YAAY;AAAM;AAAA,EAErC;AAED;AAEA,SAAS,QAAS,OAAQ;AAEzB,UAAS,MAAM,MAAO;AAAA,IAErB,KAAK;AAAA,IACL,KAAK;AAAQ,WAAK,eAAe;AAAO;AAAA,IAExC,KAAK;AAAA,IACL,KAAK;AAAQ,WAAK,YAAY;AAAO;AAAA,IAErC,KAAK;AAAA,IACL,KAAK;AAAQ,WAAK,gBAAgB;AAAO;AAAA,IAEzC,KAAK;AAAA,IACL,KAAK;AAAQ,WAAK,aAAa;AAAO;AAAA,IAEtC,KAAK;AAAQ,WAAK,UAAU;AAAO;AAAA,IACnC,KAAK;AAAQ,WAAK,YAAY;AAAO;AAAA,EAEtC;AAED;AAEA,SAAS,cAAe,OAAQ;AAE/B,MAAK,KAAK,YAAY,MAAQ;AAE9B,QAAM,eAAe;AAEtB;",
  "names": []
}
